id: XSS
info:
  name: XSS Multiple Detection Template
  author: Luca Marsilia
  severity: medium
  description: Searches for multiple XSS payloads using a headless approach
  tags: XSS

headless:
  - steps:
      - args:
          url: "{{BaseURL}}/?search={{FUZZ}}"
        action: navigate

      - action: waitdialog
        name: reflected_param_query

    payloads:
      FUZZ: output.txt


    matchers:
      - type: dsl
        dsl:
          - reflected_param_query == true
          - 'contains(tolower(reflected_param_query_message), '''')' #reflected_param_query_message == "7" # 3+4
        condition: and
